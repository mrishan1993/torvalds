"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TezosBalance = void 0;
var tslib_1 = require("tslib");
// eslint-disable-next-line camelcase
var tezos_sdk_1 = require("@rarible/tezos-sdk");
var bignumber_js_1 = (0, tslib_1.__importDefault)(require("bignumber.js"));
var common_1 = require("./common");
var TezosBalance = /** @class */ (function () {
    function TezosBalance(provider, apis) {
        this.provider = provider;
        this.apis = apis;
        this.getBalance = this.getBalance.bind(this);
    }
    TezosBalance.prototype.getBalance = function (address, assetType) {
        return (0, tslib_1.__awaiter)(this, void 0, void 0, function () {
            var tezosAssetType, balance, _a;
            return (0, tslib_1.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        tezosAssetType = (0, common_1.getTezosAssetType)(assetType);
                        if (tezosAssetType.asset_class !== "XTZ" && tezosAssetType.asset_class !== "FT") {
                            throw new Error("Unsupported asset type");
                        }
                        _a = bignumber_js_1.default.bind;
                        return [4 /*yield*/, (0, tezos_sdk_1.get_balance)((0, common_1.getRequiredProvider)(this.provider), (0, common_1.getTezosAddress)(address), tezosAssetType)];
                    case 1:
                        balance = new (_a.apply(bignumber_js_1.default, [void 0, _b.sent()]))();
                        if (tezosAssetType.asset_class === "XTZ") {
                            balance = balance.div(new bignumber_js_1.default(10).pow(common_1.XTZ_DECIMALS));
                        }
                        return [2 /*return*/, balance];
                }
            });
        });
    };
    return TezosBalance;
}());
exports.TezosBalance = TezosBalance;
