"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.awaitForItemSupply = void 0;
var tslib_1 = require("tslib");
var retry_1 = require("../../../common/retry");
function awaitForItemSupply(sdk, itemId, supply) {
    return (0, tslib_1.__awaiter)(this, void 0, void 0, function () {
        var _this = this;
        return (0, tslib_1.__generator)(this, function (_a) {
            return [2 /*return*/, (0, retry_1.retry)(10, 1000, function () { return (0, tslib_1.__awaiter)(_this, void 0, void 0, function () {
                    var item, itemSupply, requireSupply;
                    return (0, tslib_1.__generator)(this, function (_a) {
                        switch (_a.label) {
                            case 0: return [4 /*yield*/, sdk.apis.item.getItemById({
                                    itemId: itemId,
                                })];
                            case 1:
                                item = _a.sent();
                                itemSupply = item.supply.toString();
                                requireSupply = supply.toString();
                                if (itemSupply !== requireSupply) {
                                    throw new Error("Expected supply " + requireSupply + ", but current supply " + itemSupply);
                                }
                                return [2 /*return*/, itemSupply];
                        }
                    });
                }); })];
        });
    });
}
exports.awaitForItemSupply = awaitForItemSupply;
